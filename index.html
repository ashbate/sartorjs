<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Graph Network</title>
  <script src="https://d3js.org/d3.v7.min.js"></script>
  <style>
    body {
      margin: 0;
      padding: 0;
      background-color: transparent;
      overflow: hidden;
    }

    svg {
      width: 100vw;
      height: 100vh;
    }

    circle {
      fill: #69b3a2;
      stroke: #333;
      stroke-width: 1.5px;
    }

    line {
      stroke: #aaa;
      stroke-width: 6px;
    }

    .dot {
      fill: #ff5733;
      r: 8;
    }

    .trail {
      fill: none;
      stroke: #ff5733;
      stroke-width: 8;
      stroke-opacity: 0.5;
    }
  </style>
</head>
<body>
  <svg></svg>

  <script>
    const nodes = [
      { id: "Logo1", x: 150, y: 300 },
      { id: "Logo2", x: 150, y: 400 },
      { id: "Middle", x: 500, y: 350 },
      { id: "Logo3", x: 850, y: 300 },
      { id: "Logo4", x: 850, y: 400 },
    ];

    // Path segments for the defined journey
    const journeys = [
      [
        { source: "Logo1", target: "Middle" },
        { source: "Middle", target: "Logo3" }
      ],
      [
        { source: "Logo2", target: "Middle" },
        { source: "Middle", target: "Logo4" }
      ]
    ];

    const svg = d3.select("svg");

    // Draw links
    const link = svg.selectAll("path")
      .data(journeys.flat())
      .join("path")
      .attr("d", d => {
        const source = nodes.find(n => n.id === d.source);
        const target = nodes.find(n => n.id === d.target);
        const midX = (source.x + target.x) / 2;
        return `M${source.x},${source.y} 
                L${midX},${source.y} 
                L${midX},${target.y} 
                L${target.x},${target.y}`;
      })
      .attr("fill", "none")
      .attr("stroke", "#aaa")
      .attr("stroke-width", 6)
      .attr("stroke-linejoin", "round");

    // Draw nodes
    svg.selectAll("circle")
      .data(nodes)
      .join("circle")
      .attr("cx", d => d.x)
      .attr("cy", d => d.y)
      .attr("r", 20)
      .attr("fill", (d, i) => i === 2 ? "#FFD700" : "#69b3a2");

    // Add text labels
    svg.selectAll("text")
      .data(nodes)
      .join("text")
      .attr("x", d => d.x)
      .attr("y", d => d.y - 30)
      .attr("text-anchor", "middle")
      .text(d => d.id);

    // Animate dot with continuous trailing effect
    function animateDot() {
      let journeyIndex = 0;

      function startJourney() {
        if (journeyIndex >= journeys.length) {
          journeyIndex = 0; // Restart from the first journey
        }

        const journey = journeys[journeyIndex];
        const path = journey.map(d => {
          const source = nodes.find(n => n.id === d.source);
          const target = nodes.find(n => n.id === d.target);
          const midX = (source.x + target.x) / 2;
          return [
            { x: source.x, y: source.y },
            { x: midX, y: source.y },
            { x: midX, y: target.y },
            { x: target.x, y: target.y }
          ];
        }).flat();

        const dot = svg.append("circle").attr("class", "dot").attr("r", 8);
        const trailData = [];

        let pointIndex = 0;
        const totalPoints = path.length;

        function moveDot() {
          if (pointIndex >= totalPoints - 1) {
            dot.remove();
            journeyIndex++;
            setTimeout(startJourney, 1000); // Start the next journey after a delay
            return;
          }

          const { x: x1, y: y1 } = path[pointIndex];
          const { x: x2, y: y2 } = path[pointIndex + 1];

          dot.attr("cx", x1).attr("cy", y1);

          // Update trail data to add the current segment
          trailData.push({ x1, y1, x2, y2 });

          // Draw the trail
          svg.selectAll(".trail")
            .data(trailData)
            .join("line")
            .attr("class", "trail")
            .attr("x1", d => d.x1)
            .attr("y1", d => d.y1)
            .attr("x2", d => d.x2)
            .attr("y2", d => d.y2)
            .attr("stroke", "#ff5733")
            .attr("stroke-width", 8)
            .attr("stroke-opacity", 0.5);

          dot.transition()
            .duration(1000) // Smoother movement for a continuous effect
            .attr("cx", x2)
            .attr("cy", y2)
            .on("end", () => {
              pointIndex++;
              moveDot();
            });
        }

        moveDot();
      }

      startJourney();
    }

    // Start the animation
    animateDot();
  </script>
</body>
</html>
